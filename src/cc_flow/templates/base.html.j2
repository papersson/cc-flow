<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code - Session Flow</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;600&family=Source+Code+Pro:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* highlight.js github-dark theme (inlined) */
        {{ hljs_github_dark_min_css | safe }}
    </style>
    <style>
        {{ styles_css | safe }}
    </style>
</head>
<body>
    <div id="nav-bar">
        <div class="nav-logo">
            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
            <span class="nav-title">cc-flow</span>
        </div>
        <span class="nav-sep">|</span>
        <div id="breadcrumb">
            <span class="breadcrumb-item current">Session</span>
        </div>
        <div id="controls">
            <button onclick="resetView()">Reset</button>
            <button onclick="zoomIn()">+</button>
            <button onclick="zoomOut()">-</button>
        </div>
    </div>

    <div id="canvas-container">
        <div id="canvas"><svg class="edges"></svg></div>
    </div>

    <div id="status-bar">
        <div class="status-item">
            <span class="status-dot"></span>
            <span id="segment-count">0 segments</span>
        </div>
        <div class="status-item">
            <span id="turn-count">0 turns</span>
        </div>
        <div class="status-item">
            <span id="zoom-level">100%</span>
        </div>
        <div class="status-item" style="margin-left: auto;">
            drag to pan | scroll to zoom | click card to expand
        </div>
    </div>

    <div id="modal-backdrop" class="modal-backdrop"></div>
    <div id="card-modal" class="card-modal">
        <div class="card-modal-content">
            <div class="modal-header">
                <span class="modal-time" id="modal-time"></span>
                <div class="modal-actions">
                    <button class="modal-btn" id="modal-copy-btn">
                        <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                        Copy
                    </button>
                    <button class="modal-btn modal-close" id="modal-close-btn">&times;</button>
                </div>
            </div>
            <div class="modal-user-section" id="modal-user-section">
                <div class="modal-user-label" id="modal-user-label">Human</div>
                <div class="modal-user-message" id="modal-user-message"></div>
            </div>
            <div class="modal-response" id="modal-response"></div>
        </div>
    </div>

    <!-- Image Lightbox -->
    <div id="image-lightbox">
        <button id="lightbox-close">&times;</button>
        <img id="lightbox-image" src="" alt="Image preview">
        <div id="lightbox-error">
            <p>Image not embedded</p>
            <p style="font-size: 0.85rem; margin-top: 8px;">Re-run with <code style="background: var(--surface); padding: 2px 6px; border-radius: 3px;">--embed-images</code> to include images in the HTML.</p>
        </div>
        <div id="lightbox-path"></div>
        <button id="lightbox-copy-btn">
            <svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
            Copy path to clipboard
        </button>
    </div>

    <script>{{ marked_min_js | safe }}</script>
    <script>{{ highlight_min_js | safe }}</script>
    <script>
        const data = {{ session_json | safe }};
        {{ app_js | safe }}
    </script>
</body>
</html>
